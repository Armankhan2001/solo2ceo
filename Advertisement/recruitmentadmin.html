<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Job Applications | Solo2CEO</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; }
    
    /* Smooth Animation */
    @keyframes slideIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-card { animation: slideIn 0.4s ease-out forwards; }

    /* New Badge Pulse */
    @keyframes pulse-green {
        0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
        70% { box-shadow: 0 0 0 6px rgba(16, 185, 129, 0); }
        100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
    }
    .badge-new { animation: pulse-green 2s infinite; }

    /* Toast Notification */
    #toast {
        visibility: hidden;
        min-width: 250px;
        background-color: #1e293b;
        color: #fff;
        text-align: center;
        border-radius: 8px;
        padding: 12px;
        position: fixed;
        z-index: 100;
        left: 50%;
        bottom: 30px;
        transform: translateX(-50%);
        font-size: 14px;
        opacity: 0;
        transition: opacity 0.3s, bottom 0.3s;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    #toast.show { visibility: visible; opacity: 1; bottom: 50px; }
  </style>
</head>
<body class="text-slate-800">

  <header class="bg-white/80 backdrop-blur-md border-b border-slate-200 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <div class="bg-indigo-600 text-white w-10 h-10 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-200">
                <i class="fas fa-user-tie text-lg"></i>
            </div>
            <div>
                <h1 class="text-xl font-bold text-slate-900 leading-none">Job Applications</h1>
                <p class="text-xs text-slate-500 font-medium mt-1">Live Dashboard</p>
            </div>
        </div>
        <div class="text-right">
            <p id="totalCount" class="text-2xl font-bold text-indigo-600">0</p>
            <p class="text-[10px] text-slate-400 font-bold uppercase tracking-wider">Candidates</p>
        </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-4 mb-8">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div class="relative">
                <i class="fas fa-search absolute left-3.5 top-3.5 text-slate-400"></i>
                <input id="searchInput" type="text" placeholder="Search name, email..." 
                    class="w-full pl-10 pr-4 py-2.5 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500 outline-none transition-all text-sm bg-slate-50">
            </div>
            
            <select id="filterIndustry" class="w-full px-3 py-2.5 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500 outline-none text-sm bg-slate-50 cursor-pointer">
                <option value="">üè¢ All Industries</option>
                <option value="Travel Industry">Travel Industry</option>
                <option value="Real Estate Industry">Real Estate Industry</option>
                <option value="Medical Industry">Medical Industry</option>
                <option value="Food Branding Industry">Food Branding</option>
                <option value="Mobile Industry">Mobile Industry</option>
                <option value="Other Industry">Other Industry</option>
            </select>

            <select id="filterJobType" class="w-full px-3 py-2.5 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500 outline-none text-sm bg-slate-50 cursor-pointer">
                <option value="">üíº All Job Types</option>
                <option value="Internship">Internship</option>
                <option value="Full Time">Full Time</option>
                <option value="Part Time">Part Time</option>
            </select>

            <select id="filterQualification" class="w-full px-3 py-2.5 rounded-xl border border-slate-200 focus:ring-2 focus:ring-indigo-500 outline-none text-sm bg-slate-50 cursor-pointer">
                <option value="">üéì All Qualifications</option>
                <option value="10th Pass">10th Pass</option>
                <option value="12th Pass">12th Pass</option>
                <option value="Graduate">Graduate</option>
                <option value="Other">Other</option>
            </select>
        </div>
    </div>

    <div id="loadingContainer" class="flex flex-col items-center justify-center py-20 text-slate-400">
        <i class="fas fa-circle-notch fa-spin text-4xl text-indigo-500 mb-4"></i>
        <p>Loading applications...</p>
    </div>

    <div id="cardsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 hidden"></div>
    
  </main>

  <div id="toast"><i class="fas fa-check-circle text-green-400 mr-2"></i> Copied to clipboard!</div>

  <script>
    // 1. CONFIG: Your CSV URL
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRTzdvmfVRC6ZgkxgLpjkILouwicSPGn3LfGuV2GG2LQ9wwq_XkLj-Oh7kpGYGCdyqTD6KJncJeB7C9/pub?gid=1058827201&single=true&output=csv";

    const container = document.getElementById("cardsContainer");
    const loadingContainer = document.getElementById("loadingContainer");
    const totalCountEl = document.getElementById("totalCount");
    const toast = document.getElementById("toast");
    
    let allData = [];

    // 2. FETCH DATA
    Papa.parse(CSV_URL, {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
            allData = results.data;

            // SORT: Newest Date First
            allData.sort((a, b) => {
                const timeA = new Date(a.Timestamp || 0);
                const timeB = new Date(b.Timestamp || 0);
                return timeB - timeA; 
            });

            loadingContainer.classList.add("hidden");
            container.classList.remove("hidden");
            renderCards(allData);
        },
        error: function(err) {
            loadingContainer.innerHTML = `<div class="text-red-500 font-bold">‚ùå Error loading data.</div>`;
        }
    });

    // 3. DATE FORMATTER (Fixed)
    function formatDate(dateStr) {
        if (!dateStr || dateStr === "undefined") return { formatted: "Date N/A", isRecent: false };
        
        const date = new Date(dateStr);
        if (isNaN(date.getTime())) return { formatted: dateStr, isRecent: false }; // Return original string if invalid date

        // Format: Oct 14, 2025 ‚Ä¢ 2:30 PM
        const options = { 
            month: 'short', 
            day: 'numeric', 
            year: 'numeric', 
            hour: 'numeric', 
            minute: 'numeric', 
            hour12: true 
        };
        const formatted = new Intl.DateTimeFormat('en-US', options).format(date).replace(",", " ‚Ä¢");

        // Check if within last 3 days
        const diffDays = (new Date() - date) / (1000 * 60 * 60 * 24);
        const isRecent = diffDays < 3;

        return { formatted, isRecent };
    }

    // 4. HELPERS
    function getIndustryColor(ind) {
        const colors = {
            "Travel Industry": "bg-blue-50 text-blue-700 border-blue-200",
            "Real Estate Industry": "bg-amber-50 text-amber-800 border-amber-200",
            "Medical Industry": "bg-emerald-50 text-emerald-700 border-emerald-200",
            "Food Branding Industry": "bg-orange-50 text-orange-700 border-orange-200",
            "Mobile Industry": "bg-purple-50 text-purple-700 border-purple-200"
        };
        return colors[ind] || "bg-slate-50 text-slate-700 border-slate-200";
    }

    function getAvatarColor(name) {
        if(!name) return "bg-gray-400";
        const colors = ["bg-indigo-500", "bg-rose-500", "bg-teal-500", "bg-blue-500", "bg-violet-500"];
        let hash = 0;
        for (let i = 0; i < name.length; i++) hash = name.charCodeAt(i) + ((hash << 5) - hash);
        return colors[Math.abs(hash) % colors.length];
    }

    window.copyText = function(text) {
        if(!text) return;
        navigator.clipboard.writeText(text);
        toast.className = "show";
        setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 3000);
    }

    // 5. RENDER CARDS
    function renderCards(data) {
        container.innerHTML = "";
        totalCountEl.textContent = data.length;

        if (data.length === 0) {
            container.innerHTML = `<div class="col-span-full text-center py-10 text-slate-400">No applications found.</div>`;
            return;
        }

        data.forEach((row, index) => {
            if(!row.Name) return; 

            // Handle Date
            const { formatted: dateDisplay, isRecent } = formatDate(row.Timestamp);

            // Handle Initials
            const initials = row.Name.split(" ").map(n=>n[0]).slice(0,2).join("").toUpperCase();
            const avatarBg = getAvatarColor(row.Name);
            const industryClass = getIndustryColor(row.Industry);

            // New Badge
            const newBadge = isRecent ? 
                `<span class="absolute top-4 right-4 bg-green-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full badge-new shadow-sm z-10">NEW</span>` : '';

            const card = document.createElement("div");
            card.className = "bg-white rounded-2xl p-5 shadow-sm border border-slate-200 hover:shadow-xl hover:border-indigo-100 transition-all duration-300 animate-card relative group flex flex-col";
            card.style.animationDelay = `${Math.min(index * 50, 500)}ms`;

            card.innerHTML = `
                ${newBadge}

                <div class="flex items-start gap-4 mb-4">
                    <div class="${avatarBg} w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-sm shadow-sm ring-2 ring-white shrink-0">
                        ${initials}
                    </div>
                    <div class="overflow-hidden">
                        <h3 class="font-bold text-slate-900 text-lg truncate group-hover:text-indigo-600 transition-colors">${row.Name}</h3>
                        <p class="text-xs text-slate-500 font-medium flex items-center mt-0.5">
                            <i class="far fa-clock mr-1.5 text-indigo-400"></i> ${dateDisplay}
                        </p>
                    </div>
                </div>

                <div class="flex flex-wrap gap-2 mb-4">
                    <span class="px-2.5 py-1 rounded text-xs font-semibold border ${industryClass}">${row.Industry || 'N/A'}</span>
                    <span class="px-2.5 py-1 rounded text-xs font-semibold bg-slate-100 text-slate-600 border border-slate-200">${row["Job Type"] || 'N/A'}</span>
                </div>

                <div class="bg-slate-50 rounded-xl p-3 border border-slate-100 space-y-2 mb-4">
                    <div class="flex justify-between items-center group/item">
                        <div class="flex items-center gap-2 text-sm text-slate-600 truncate mr-2">
                            <i class="far fa-envelope text-slate-400 w-4"></i>
                            <span class="truncate" title="${row.Email}">${row.Email || 'No Email'}</span>
                        </div>
                        <button onclick="copyText('${row.Email}')" class="text-slate-300 hover:text-indigo-600 transition-colors" title="Copy"><i class="far fa-copy"></i></button>
                    </div>
                    <div class="flex justify-between items-center group/item">
                        <div class="flex items-center gap-2 text-sm text-slate-600">
                            <i class="fas fa-phone-alt text-slate-400 w-4"></i>
                            <span>${row.Phone || 'No Phone'}</span>
                        </div>
                        <button onclick="copyText('${row.Phone}')" class="text-slate-300 hover:text-indigo-600 transition-colors" title="Copy"><i class="far fa-copy"></i></button>
                    </div>
                     <div class="flex items-center gap-2 text-sm text-slate-600">
                        <i class="fas fa-map-marker-alt text-slate-400 w-4"></i>
                        <span class="truncate">${row.Location || 'Location N/A'}</span>
                    </div>
                </div>

                <div class="mt-auto pt-3 border-t border-slate-100">
                     <p class="text-xs font-semibold text-slate-500 mb-1">üéì ${row.Qualification || 'N/A'}</p>
                    <p class="text-xs text-slate-400 italic line-clamp-2">"${row.Message || 'No additional message.'}"</p>
                </div>
            `;
            container.appendChild(card);
        });
    }

    // 6. FILTER LOGIC
    const searchInput = document.getElementById("searchInput");
    const filterIndustry = document.getElementById("filterIndustry");
    const filterJobType = document.getElementById("filterJobType");
    const filterQualification = document.getElementById("filterQualification");

    function applyFilters() {
        const searchVal = searchInput.value.toLowerCase();
        const industryVal = filterIndustry.value;
        const jobVal = filterJobType.value;
        const qualVal = filterQualification.value;

        const filtered = allData.filter(row => {
            const matchesSearch = (
                (row.Name && row.Name.toLowerCase().includes(searchVal)) ||
                (row.Email && row.Email.toLowerCase().includes(searchVal)) ||
                (row.Location && row.Location.toLowerCase().includes(searchVal))
            );
            return matchesSearch &&
                (!industryVal || row.Industry === industryVal) &&
                (!jobVal || row["Job Type"] === jobVal) &&
                (!qualVal || row.Qualification === qualVal);
        });

        renderCards(filtered);
    }

    searchInput.addEventListener("input", applyFilters);
    filterIndustry.addEventListener("change", applyFilters);
    filterJobType.addEventListener("change", applyFilters);
    filterQualification.addEventListener("change", applyFilters);

  </script>
</body>
</html>